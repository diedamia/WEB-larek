# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура приложения

В качестве архитектурного паттерна был выбран **MVP (Model-View-Presenter)**. Проект разбит на три модуля:

- **Model** — реализация логики работы сайта.
- **View** — представление данных пользователю.
- **Presenter** — брокер событий, связывающий логику с представлением.

### Модель (Model)

Модель отвечает за данные и их обработку. Основные объекты:

- **Товар**:
  - идентификатор товара;
  - описание товара;
  - ссылка на изображение;
  - название товара;
  - категория товара;
  - цена товара.
- **Пользователь**:
  - способ оплаты;
  - адрес доставки;
  - почта пользователя;
  - телефон пользователя.

### Представление (View)

Представление отвечает за отображение данных пользователю. Основные компоненты:

- **Главная страница**:
  - карточки с данными товаров;
  - ссылка на корзину.
- **Модальное окно товара**:
  - данные товара;
  - кнопка "В корзину";
  - кнопка закрытия окна.
- **Модальное окно корзины**:
  - список выбранных товаров;
  - кнопки для удаления товаров;
  - кнопка "Оформить";
  - кнопка закрытия окна.
- **Модальное окно формы оплаты**:
  - выбор способа оплаты;
  - поле ввода адреса доставки;
  - кнопка "Далее";
  - кнопка закрытия окна.
- **Модальное окно формы контактов**:
  - поле ввода почты;
  - поле ввода телефона;
  - кнопка "Оплатить";
  - кнопка закрытия окна.
- **Модальное окно Успешной покупки**:
  - кнопка "За новыми покупками!";
  - кнопка закрытия окна.

### Брокер событий (Presenter)

Брокер событий связывает модель и представление при наступлении определённого события, например:

- добавление товара в корзину;
- удаление товара из корзины;
- оформление заказа.

## Основные классы и их функции

### Модель (Model)

- **Класс Product**

    **Описание**: Хранит информацию о товаре.

    **Свойства**:

    - id: string — уникальный идентификатор товара;
    - description: string — описание товара;
    - image: string — ссылка на изображение;
    - title: string — название товара;
    - category: Category — категория товара;
    - price: number | null — цена товара (может быть null, если товар бесплатный).

- **Класс User**

    **Описание**: Хранит информацию о пользователе.

    **Свойства**:
    - payment: PaymentType — способ оплаты;
    - address: string — адрес доставки;
    - email: string — почта пользователя;
    - phone: string — телефон пользователя.

    **Методы**:
    - setPayment(payment: PaymentType): void — устанавливает способ оплаты;
    - setAddress(address: string): void — устанавливает адрес доставки;
    - setEmail(email: string): void — устанавливает почту;
    - setPhone(phone: string): void — устанавливает телефон.

- **Класс Cart**

    **Описание**: Управляет корзиной пользователя.

    **Свойства**:
    items: Product[] — список товаров в корзине.

    **Методы**:
    - add(product: Product): void — добавляет товар в корзину;
    - remove(id: string): void — удаляет товар из корзины;
    - getTotal(): number — возвращает общую стоимость товаров в корзине.

- **Класс Api**

    **Описание**: Обеспечивает взаимодействие с сервером через HTTP-запросы.

    **Методы**:

    - get(uri: string): Promise<object> — выполняет GET-запрос;
    - post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object> — выполняет POST-, PUT- или DELETE-запрос.

### Представление (View)
Основные компоненты:

- **Класс ModalView**
    
    **Описание**: Управляет отображением и поведением модальных окон.

    **Методы**:
    - onOpen(callback: () => void): void — отображает модальное окно;
    - onClose(callback: () => void): void — закрывает модальное окно.

- **Класс CatalogView**
    
    **Описание**: Отображает каталог товаров.

    **Методы**:
    - render(products: Product[]): void — отображает список товаров;
    - onProductClick(callback: (id: string) => void): void — обрабатывает клик по товару;
    - onGoToCart(callback: () => void): void — обрабатывает переход к модальному окну корзины.

- **Класс ProductModalView**
    
    **Описание**: Отображает модальное окно с детальной информацией о товаре.

    **Методы**:
    - render(product: Product): void — отображает информацию о товаре;
    - onAddToCart(callback: () => void): void — обрабатывает добавление товара в корзину.

- **Класс CartView**
    
    **Описание**: Отображает корзину пользователя.

    **Методы**:

    - render(items: Product[]): void — отображает список товаров в корзине;
    - renderTotal(total: number): void - отображает стоимость товаров в корзине;
    - onRemoveItem(callback: (id: string) => void): void — обрабатывает удаление товара из корзины;
    - onCheckout(callback: () => void): void — обрабатывает переход к оформлению заказа.

- Класс **OrderFormView**

    **Описание**: Отображает форму оформления заказа.

    **Методы**:
    - render(): void — отображает форму;
    - onNextStep(callback: () => void): void — обрабатывает переход к следующему шагу.

- Класс **ContactFormView**
    
    **Описание**: Отображает форму ввода контактных данных.

    **Методы**:
    - render(): void — отображает форму;
    - onSubmit(callback: () => void): void — обрабатывает отправку формы.

- **Класс SuccessModalView**

    **Описание**: Отображает модальное окно с сообщением об успешной покупке.

    **Методы**:
    - render(total: number): void — отображает модальное окно с сообщением об успешной покупке;
    - onContinueShopping(callback: () => void): void — обрабатывает клик по кнопке "За новыми покупками!".

### Брокер событий (Presenter)
- Класс EventEmitter

    **Описание**: Реализует паттерн «Наблюдатель» и обеспечивает работу событий. Позволяет подписываться на события, отписываться от них и уведомлять подписчиков о наступлении событий.

    **Методы**:
    - on<T extends object>(eventName: EventName, callback: (data: T) => void): void — подписывает на событие;
    - off(eventName: EventName, callback: Subscriber): void — отписывает от события;
    - emit<T extends object>(eventName: string, data?: T): void — уведомляет подписчиков о наступлении события;
    - onAll(callback: (event: EmitterEvent) => void): void — подписывает на все события;
    - offAll(): void — сбрасывает все подписки;
    - trigger<T extends object>(eventName: string, context?: Partial<T>): (data: T) => void — создаёт триггер, который генерирует событие при вызове.
