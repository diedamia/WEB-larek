# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура приложения

В качестве архитектурного паттерна был выбран **MVP (Model-View-Presenter)**. Проект разбит на три модуля:

- **Model** — реализация логики работы сайта.
- **View** — представление данных пользователю.
- **Presenter** — брокер событий, связывающий логику с представлением.

### Модель (Model)

Модель отвечает за данные и их обработку. Основные компоненты:

- **BasketModel** - управление корзиной
- **CatalogModel** - работа с каталогом товаров  
- **FormModel** - обработка данных формы заказа
- **ApiModel** - взаимодействие с API

### Представление (View)

Представление отвечает за отображение данных пользователю. ООсновные компоненты:

- **Modal** - базовое модальное окно
- **Catalog** - отображение каталога
- **ProductModal** - модальное окно товара
- **Basket** - отображение корзины  
- **OrderForm** - форма оплаты/адреса
- **ContactsForm** - форма контактов
- **SuccessModal** - окно успешного заказа

### Брокер событий (Presenter)

Брокер событий связывает модель и представление при наступлении определённого события.

- **EventEmitter** - брокер событий, связывающий Model и View

## Основные классы и их функции

## Архитектура MVP

### Модель (Model)

Модель отвечает за данные и их обработку. Основные компоненты:

- **BasketModel** - управление корзиной
- **CatalogModel** - работа с каталогом товаров  
- **FormModel** - обработка данных формы заказа
- **ApiModel** - взаимодействие с API

### Представление (View)

Представление отвечает за отображение данных. Основные компоненты:

- **Modal** - базовое модальное окно
- **Catalog** - отображение каталога
- **ProductModal** - модальное окно товара
- **Basket** - отображение корзины  
- **OrderForm** - форма оплаты/адреса
- **ContactsForm** - форма контактов
- **SuccessModal** - окно успешного заказа

### Посредник (Presenter)

- **EventEmitter** - брокер событий, связывающий Model и View

## Модели данных

### BasketModel

**Назначение**: Управление состоянием корзины

**Методы**:
- `add(item)` - добавить товар
- `remove(id)` - удалить товар  
- `clear()` - очистить корзину
- `contains(id)` - проверка наличия товара

### CatalogModel

**Назначение**: Хранение и управление каталогом товаров

**Свойства**:
- `productCards` - список товаров
- `selectedCard` - выбранный товар

### FormModel  

**Назначение**: Валидация и обработка данных формы

**Методы**:
- `setField(field, value)` - установка значения поля
- `validate()` - проверка валидности
- `getOrderData()` - получение данных для заказа

## Представления (View)

### Modal (Базовое модальное окно)

**Назначение**: Базовый компонент для всех модальных окон

**Методы**:
- `open()` - открытие модального окна
- `close()` - закрытие модального окна
- `set content(value: HTMLElement)` - установка содержимого

**Особенности**:
- Блокировка прокрутки страницы при открытии
- Закрытие по клику вне контента или на крестик

### Catalog (Каталог товаров)

**Назначение**: Отображение списка товаров

**Методы**:
- `render(products: IProduct[])` - отрисовка каталога
- `updateCounter(count: number)` - обновление счетчика корзины

**Особенности**:
- Использует шаблон карточки товара
- Генерирует событие выбора товара

### ProductModal (Модальное окно товара)

**Назначение**: Детальное отображение товара

**Методы**:
- `render(product: IProduct)` - отрисовка данных товара
- `setButtonState(state: boolean)` - управление состоянием кнопки

**Особенности**:
- Автоматическая блокировка кнопки для товаров без цены
- Сохранение состояния кнопки при повторном открытии
- Отображение категории с соответствующим стилем

### Basket (Корзина)

**Назначение**: Отображение содержимого корзины

**Методы**:
- `render(items: IProduct[], total: number)` - первичная отрисовка
- `update(items: IProduct[], total: number)` - обновление данных

**Особенности**:
- Список товаров с нумерацией
- Кнопки удаления для каждого товара
- Автоматическое отключение кнопки оформления при пустой корзине

### OrderForm (Форма оплаты/адреса)

**Назначение**: Первый шаг оформления заказа

**Методы**:
- `render()` - инициализация формы
- `validate()` - проверка заполненности полей

**Особенности**:
- Переключение способов оплаты с визуальным выделением
- Валидация обязательных полей перед переходом
- Отображение ошибок заполнения

### ContactsForm (Форма контактов)

**Назначение**: Второй шаг оформления заказа

**Методы**:
- `render()` - инициализация формы
- `validate()` - проверка валидности данных

**Особенности**:
- Валидация email и телефона
- Блокировка кнопки отправки при ошибках
- Отображение сообщений об ошибках

### SuccessModal (Окно успешного заказа)

**Назначение**: Отображение подтверждения заказа

**Методы**:
- `render(total: number)` - отображение итоговой суммы

**Особенности**:
- Показывает сумму списания
- Единственная кнопка продолжения покупок
- Автоматическое закрытие при клике

## Брокер событий (Presenter)
- Класс EventEmitter

  **Описание**: Реализует паттерн «Наблюдатель» и обеспечивает работу событий. Позволяет подписываться на события, отписываться от них и уведомлять подписчиков о наступлении событий.

  **Методы**:
  - on<T extends object>(eventName: EventName, callback: (data: T) => void): void — подписывает на событие;
  - off(eventName: EventName, callback: Subscriber): void — отписывает от события;
  - emit<T extends object>(eventName: string, data?: T): void — уведомляет подписчиков о наступлении события;
  - onAll(callback: (event: EmitterEvent) => void): void — подписывает на все события;
  - offAll(): void — сбрасывает все подписки;
  - trigger<T extends object>(eventName: string, context?: Partial<T>): (data: T) => void — создаёт триггер, который генерирует событие при вызове.
